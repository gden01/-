Основная цель программы — автоматическая классификация образцов ЛКМ на группу **негорючих (НГ, Label=0)** и **горючих (Г, Label=1)** на основе их элементного состава.

## Описание программы и алгоритмов

### I. Входные данные и признаковое пространство

1.  **Датасет исследованных ЛКМ:** Программа загружает экспериментальную выборку, состоящую из **53 образцов** лакокрасочных материалов. По результатам огневых испытаний (ГОСТ 30244-94), 34 образца (64,2%) отнесены к НГ, а 19 образцов (35,8%) — к Г.
2.  **Целевая переменная (Label):** Бинарная классификация:
    *   **Label = 0** (Негорючий материал, НГ)
    *   **Label = 1** (Горючий материал, Г)
3.  **Признаковое пространство (X):** В качестве признаков для обучения модели используются данные **элементного состава**, полученные методом РФА. Определялись содержания **16 элементов**:
    *   Mg, Al, Si, P, S, Cl, K, Ca, Ti, V, Cr, Mn, Fe, Ni, Cu, Zn.


### II. Алгоритм предобработки данных (Pipeline)

Перед обучением нейронной сети данные проходят обязательную предобработку, которая полностью инкапсулирована в конвейер (Pipeline) для предотвращения утечек данных.

1.  **Стандартизация признаков (Z-score):** Все 16 признаков стандартизируются, чтобы обеспечить сопоставимость по масштабу, что ускоряет и стабилизирует обучение нейронной сети. Стандартизация выполняется по формуле:
    $$z = (x - \mu) / \sigma$$
    где $x$ — исходное значение концентрации элемента, $\mu$ — среднее значение, $\sigma$ — стандартное отклонение по **обучающей выборке**.

2.  **Протокол валидации:** Исследование проводилось с использованием строгого протокола **вложенной кросс-валидации (nested cross-validation 5×3-fold)**. Этот протокол необходим для оценки обобщающей способности модели и подбора гиперпараметров, предотвращая при этом утечки данных.

### III. Алгоритм обучения модели (MLP)

В качестве основного классификатора используется **Многослойный Персептрон (MLP)** — многослойная полносвязная нейронная сеть.

1.  **Оптимальная Архитектура:**
    *   Сеть состоит из двух скрытых слоев.
    *   Архитектура: **(100, 50) нейронов** (100 нейронов в первом скрытом слое и 50 во втором). Эта конфигурация была признана оптимальной по результатам валидации.

2.  **Функции активации:**
    *   Для скрытых слоев: **ReLU** (Rectified Linear Unit), которая ускоряет обучение.
    *   Для выходного слоя: **Сигмоидная функция**, которая обеспечивает интерпретацию выхода как вероятности принадлежности к классу.

3.  **Оптимизация и Регуляризация:**
    *   **Оптимизатор:** Используется алгоритм **Adam** с `learning_rate=0.001`, который гарантирует быструю и устойчивую сходимость.
    *   **Регуляризация:** Применяется **раннее прекращение обучения (early stopping)**. Обучение завершается, если целевая метрика на валидации не улучшалась **15 эпох подряд** (`patience=15`), с восстановлением лучших весов, что предотвращает переобучение.

### IV. Алгоритм классификации нового образца

После обучения модель используется для прогнозирования горючести/негорючести новых, неизвестных образцов:

1.  **Ввод данных:** Программа принимает входной датасет (одну строку) с химическим составом (включая все 34 Ваших элемента), но **для предсказания используются только 16 элементов**, на которых обучалась модель (Mg, Al, Si, P, S, Cl, K, Ca, Ti, V, Cr, Mn, Fe, Ni, Cu, Zn).
2.  **Предобработка:** Входные 16 признаков пропускаются через обученный конвейер (`Pipeline`), где они стандартизируются, используя $\mu$ и $\sigma$, полученные на этапе обучения.
3.  **Прогноз вероятности:** Модель MLP выдает вероятность $P(\text{Г})$, то есть вероятность того, что материал является горючим (Label=1).
4.  **Применение консервативного порога:** Классификация производится с использованием **консервативного порога вероятности 0,3**.
    *   **Если $P(\text{Г}) \ge 0,3$**: Прогноз — **Горючий (Label=1)**.
    *   **Если $P(\text{Г}) < 0,3$**: Прогноз — **Негорючий (Label=0)**.

Использование порога 0,3 критически важно, так как при этом достигается **100% чувствительность** (доля верно распознанных горючих материалов). Такой консервативный подход позволяет исключить до **40%** образцов из трудоемких огневых испытаний без потери безопасности.

### V. Ключевые зависимости (для интерпретации)

Хотя MLP сложен для прямой интерпретации, исследование выявило, что прогнозирование основано на содержании четырех элементов, показывающих статистически значимые различия ($p < 0,001$):

*   **Кальций (Ca), Железо (Fe), Магний (Mg):** Их повышенное содержание коррелирует с **негорючестью** (НГ). Это объясняется тем, что карбонаты кальция разлагаются по эндотермической реакции, а оксиды железа способствуют образованию углеродистых остатков.
*   **Титан (Ti):** Повышенное содержание Ti коррелирует с **горючестью** (Г) (обратная корреляция). Это связано с тем, что титан используется в качестве пигмента (TiO₂) преимущественно в органических (горючих) красках.
═══════════════════════════════════════════════════════════════
  ИНСТРУКЦИЯ ПО ЗАПУСКУ ПРОГРАММЫ
  Предиктор горючести красок на основе химического состава
═══════════════════════════════════════════════════════════════

СПОСОБ 1: ЗАПУСК ГОТОВОЙ ОФЛАЙН-ВЕРСИИ (без установки Node.js)
───────────────────────────────────────────────────────────────

1. Откройте папку "dist" в корне проекта.

2. Запустите файл "index.html" двойным кликом.
   Приложение откроется в браузере.

3. Если браузер блокирует загрузку:
   - Откройте командную строку (Win + R → cmd)
   - Перейдите в папку dist:
     cd путь_к_проекту\dist
   - Запустите локальный сервер:
     npx serve
   - Откройте браузер по адресу: http://localhost:3000

───────────────────────────────────────────────────────────────

СПОСОБ 2: ЗАПУСК В РЕЖИМЕ РАЗРАБОТКИ (требует Node.js)
───────────────────────────────────────────────────────────────

ПЕРВИЧНАЯ НАСТРОЙКА (выполняется один раз):

1. Установите Node.js:
   - Скачайте LTS-версию с https://nodejs.org/
   - Запустите установщик и следуйте инструкциям.

2. Откройте командную строку:
   - Нажмите Win + R
   - Введите: cmd
   - Нажмите Enter

3. Перейдите в папку проекта:
   cd C:\путь_к_вашей_папке

4. Установите зависимости:
   npm install
   (эта команда выполняется только при первом запуске)

ЕЖЕДНЕВНЫЙ ЗАПУСК:

5. Запустите сервер разработки:
   npm run dev

   ИЛИ просто запустите файл runme.bat двойным кликом.

6. Откройте браузер по адресу:
   http://localhost:3000/

───────────────────────────────────────────────────────────────

СБОРКА НОВОЙ ОФЛАЙН-ВЕРСИИ (если изменяли код)
───────────────────────────────────────────────────────────────

Если вы изменили исходный код и хотите пересобрать папку dist:

1. Откройте командную строку в папке проекта
2. Выполните команду:
   npm run build
3. Новая офлайн-версия появится в папке dist/

───────────────────────────────────────────────────────────────

ДОПОЛНИТЕЛЬНАЯ ИНФОРМАЦИЯ
───────────────────────────────────────────────────────────────

• Приложение работает полностью локально.
• НЕ требует интернета после первой установки.
• НЕ использует Google API или внешние сервисы.
• Обучение модели происходит в браузере (TensorFlow.js).

Технологии: React, TypeScript, TensorFlow.js, Vite

───────────────────────────────────────────────────────────────

РЕШЕНИЕ ПРОБЛЕМ
───────────────────────────────────────────────────────────────

Проблема: PowerShell блокирует выполнение npm
Решение: Используйте командную строку (cmd) вместо PowerShell.

Проблема: Браузер не открывает dist/index.html
Решение: Используйте локальный сервер (npx serve в папке dist).

Проблема: "npm не найден"
Решение: Установите Node.js с официального сайта.

═══════════════════════════════════════════════════════════════


# Техническая документация

## 1. Назначение программы

**Combustibility Predictor for Paints** — это интерактивное веб-приложение, предназначенное для предсказания класса горючести лакокрасочных материалов на основе их химического состава. Приложение выполняет обработку входных данных, обучение модели и выдаёт предсказание прямой в браузере пользователя, без использования внешних API и серверной обработки.

***

## 2. Краткое описание работы

- **Вводимые данные**: массовые доли оксидов и элементов — MgO, Al₂O₃, SiO₂, P, S, Cl, K, Ca, Ti, V, Cr, Mn, Fe, Ni, Cu, Zn.
- **Вычисления**: преобразование оксидов к долям элементов, нормализация, прогноз методом многослойного перцептрона.
- **Вывод**: вероятность и класс горючести (горючий/негорючий).
- **Обучение**: встроенное обучение на пользовательских/предустановленных данных — происходит локально.

***

## 3. Технологии

- **Клиентская часть**: React (TypeScript)
- **ML**: TensorFlow.js (многослойный перцептрон MLP)
- **Сборка**: Vite
- **Запуск**: Node.js + npm, либо в виде офлайн-сборки через файл dist/index.html

***

## 4. Архитектура приложения

- **App.tsx** — основной компонент, управляющий состоянием и логикой приложения
- **InputForm** — форма для ввода исходных данных
- **ResultDisplay** — визуализация результата прогноза
- **Training** — компонент обучения модели
- **constants.ts** — константы: коэффициенты пересчёта, структура признаков
- **types.ts** — типы входных/выходных данных, описание модели, scaler
- **index.tsx** — точка входа приложения

***

## 5. Алгоритм работы

1. **Оксиды MgO, Al₂O₃, SiO₂** конвертируются к элементам Mg, Al, Si по коэффициентам из constants.ts
2. Формируется массив признаков (16 позиций)
3. Данные нормализуются с помощью scaler (mean, variance)
4. Модель MLP вычисляет выходное значение (вероятность "Combustible")
5. Классификация по порогу (default: 0.3) — если выше, то "Горючий"; ниже — "Негорючий"
6. Выдаётся результат и подробности для пользователя

***

## 6. Структура входных данных

Каждая запись включает % веса оксида/элемента в составе:
- MgO, Al₂O₃, SiO₂ — исходные значения→пересчёт к элементам
- Остальные элементы — прямое внесение

***

## 7. Основные файлы

| Файл             | Назначение                                    |
|------------------|-----------------------------------------------|
| App.tsx          | Главный компонент React                       |
| constants.ts     | Химические константы, структуры признаков     |
| types.ts         | Типы данных, классы, интерфейсы               |
| index.tsx        | Точка входа приложения                        |
| package.json     | Метаинформация о зависимостях и командах      |
| vite.config.ts   | Конфигурация сборщика Vite                    |

***

## 8. Способы запуска

- **Режим разработки**:
  ```
  npm install
  npm run dev
  ```
- **Сборка продакшн-версии**:
  ```
  npm run build
  ```
  Офлайн-старт: открыть dist/index.html в браузере (или через локальный сервер).

***

## 9. Зависимости

- react, react-dom
- typescript, vite, @vitejs/plugin-react
- @tensorflow/tfjs

***

## 10. Возможности доработки и расширения

- Замена или добавление новых признаков (constants.ts)
- Тонкая настройка гиперпараметров модели MLP
- Импорт/экспорт обучающей выборки
- Добавление дополнительных форм отчётности, экспорт результата

***

## 11. Ограничения

- Приложение полностью работает на стороне клиента, вся логика и обучение — в браузере.
- Для больших датасетов скорость обучения и работа могут быть ограничены мощностью ПК пользователя.

***

## 12. Характер ошибок

- Неверный формат данных — выдаётся предупреждение
- Ошибки модуля TensorFlow.js или React — отображаются в error зоне интерфейса

***

## 13. Автор и поддержка

- Автор: Григорьев Денис Викторович
- Поддержка: GrigorievDV@str.mos.ru


